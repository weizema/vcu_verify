# VCU激活函数微码配置

## Sigmoid

$$\text{Sigmoid}(x)=\frac{1}{1+e^{x}}$$

|     算子      | 指令码 | 模式码 | 常数码 |         结果         |                             解释                             |
| :-----------: | :----: | :----: | :----: | :------------------: | :----------------------------------------------------------: |
|     $-x$      |  0011  |   00   |  000   |         $-x$         |   取反，数据来自原始寄存器，结果存入迭代寄存器，无需常数码   |
|     $e^x$     |  0100  |   10   |  000   |       $e^{-x}$       |  e指数，数据来自迭代寄存器，结果存入迭代寄存器，无需常数码   |
|     $\pm$     |  0000  |   10   |  000   |      $1+e^{-x}$      | 加法，数据来自迭代寄存器，结果存入迭代寄存器，常数码来自加法常数寄存器0 |
| $\frac{1}{x}$ |  0101  |   10   |  000   | $\frac{1}{1+e^{-x}}$ |   倒数，数据来自迭代寄存器，结果存入迭代寄存器，无需常数码   |
|               |        |        |        |                      |                                                              |


## Tanh

$$\text{Tanh}(x)=\frac{1-e^{-2x}}{1+e^{-2x}}$$

先配置参数，配置乘法常数寄存器0为2，加法常数寄存器0为1

|     算子      | 指令码 | 模式码 | 常数码 |             结果              |                             解释                             |
| :-----------: | :----: | :----: | :----: | :---------------------------: | :----------------------------------------------------------: |
|     $a*x$     |  0001  |   00   |  000   |             $2x$              | 乘法，数据来自原始寄存器，结果存入迭代寄存器，常数来自乘法常数寄存器0 |
|     $-x$      |  0011  |   10   |  000   |             $-2x$             |   取反，数据来自迭代寄存器，结果存入迭代寄存器，无需常数码   |
|    $e^{x}$    |  0100  |   10   |  000   |           $e^{-2x}$           |  e指数，数据来自迭代寄存器，结果存入迭代寄存器，无需常数码   |
|     $-x$      |  0011  |   10   |  000   |          $-e^{-2x}$           |   取反，数据来自迭代寄存器，结果存入迭代寄存器，无需常数码   |
|     $\pm$     |  0000  |   11   |  000   |          $1-e^{-2x}$          |   加法，数据来自迭代寄存器，结果存入数据寄存器，无需常数码   |
|     $-x$      |  0011  |   10   |  000   |           $e^{-2x}$           |   取反，数据来自迭代寄存器，结果存入迭代寄存器，无需常数码   |
|     $\pm$     |  0000  |   10   |  000   |          $1+e^{-2x}$          |   加法，数据来自迭代寄存器，结果存入迭代寄存器，无需常数码   |
| $\frac{1}{x}$ |  0101  |   10   |  000   |     $\frac{1}{1+e^{-2x}}$     |   倒数，数据来自迭代寄存器，结果存入迭代寄存器，无需常数码   |
|     $a*x$     |  0001  |   10   |  011   | $\frac{1-e^{-2x}}{1+e^{-2x}}$ | 乘法，数据来自迭代寄存器，结果存入常数寄存器，常数码来自数据寄存器 |
|               |        |        |        |                               |                                                              |

## LeakyReLU

$$\text{LeakyReLU}(x)=\left\{ \begin{aligned}x\ x\ge0\\ax\ x<0\end{aligned} \right.$$

先配置参数，配置乘法常数寄存器0为1，乘法常数寄存器1为0.125

| 算子  | 指令码 | 模式码 | 常数码 |   结果   |                             解释                             |
| :---: | :----: | :----: | :----: | :------: | :----------------------------------------------------------: |
| $a*x$ |  0001  |   01   |  000   |   $x$    | 乘法，数据来自原始寄存器，结果存入数据寄存器，常数码来自乘法常数寄存器0 |
| $a*x$ |  0001  |   00   |  001   | $0.125x$ | 乘法，数据来自原始寄存器，结果存入迭代寄存器，常数码来自乘法常数寄存器1 |
| $\le$ |  0110  |   00   |  000   |          |    比较，数据来自原始寄存器，结果存入迭代寄存器，无需常数    |
|       |        |        |        |          |                                                              |

## Swish

$$\text{Swish}(x)=\frac{x}{1+e^{-x}}$$

|     算子      | 指令码 | 模式码 | 常数码 |         结果         |                             解释                             |
| :-----------: | :----: | :----: | :----: | :------------------: | :----------------------------------------------------------: |
|     $-x$      |  0011  |   00   |  000   |         $-x$         |   取反，数据来自原始寄存器，结果存入迭代寄存器，无需常数码   |
|     $e^x$     |  0100  |   10   |  000   |       $e^{-x}$       |  e指数，数据来自迭代寄存器，结果存入迭代寄存器，无需常数码   |
|     $\pm$     |  0000  |   10   |  000   |      $1+e^{-x}$      |   加法，数据来自迭代寄存器，结果存入迭代寄存器，无需常数码   |
| $\frac{1}{x}$ |  0101  |   11   |  000   | $\frac{1}{1+e^{-x}}$ |   倒数，数据来自迭代寄存器，结果存入数据寄存器，无需常数码   |
|     $a*x$     |  0001  |   00   |  011   | $\frac{x}{1+e^{-x}}$ | 乘法，数据来原始寄存器，结果存入迭代寄存器，常数码来自数据寄存器 |
|               |        |        |        |                      |                                                              |

## SfotPlus

$$\text{Softplus}(x) = \ln(1 + e^{-x})$$

|   算子   | 指令码 | 模式码 | 常数码 |      结果       |                             解释                             |
| :------: | :----: | :----: | :----: | :-------------: | :----------------------------------------------------------: |
|   $-x$   |  0011  |   00   |  000   |      $-x$       |   取反，数据来自原始寄存器，结果存入迭代寄存器，无需常数码   |
| $e^{x}$  |  0100  |   10   |  000   |    $e^{-x}$     |  e指数，数据来自迭代寄存器，结果存入迭代寄存器，无需常数码   |
|  $\pm$   |  0000  |   10   |  000   |   $1+e^{-x}$    | 加法，数据来自迭代寄存器，结果存入迭代寄存器，常数码来自加法常数寄存器0 |
| $\ln(x)$ |  0010  |   10   |  000   | $\ln(1+e^{-x})$ |    ln，数据来自迭代寄存器，结果存入迭代寄存器，无需常数码    |
|          |        |        |        |                 |                                                              |

## Mish

$$f(x)=x*tanh(ln(1+e^{-x}))$$

先配置参数，配置乘法常数寄存器0为2，加法常数寄存器0为1

|     算子      | 指令码 | 模式码 | 常数码 |                         结果                         |                             解释                             |
| :-----------: | :----: | :----: | :----: | :--------------------------------------------------: | :----------------------------------------------------------: |
|     $-x$      |  0011  |   00   |  000   |                         $-x$                         |   取反，数据来自原始寄存器，结果存入迭代寄存器，无需常数码   |
|    $e^{x}$    |  0100  |   10   |  000   |                       $e^{-x}$                       |  e指数，数据来自迭代寄存器，结果存入迭代寄存器，无需常数码   |
|     $\pm$     |  0000  |   10   |  000   |                      $1+e^{-x}$                      | 加法，数据来自迭代寄存器，结果存入迭代寄存器，常数码来自加法常数寄存器0 |
|   $\ln(x)$    |  0010  |   10   |  000   |                   $\ln(1+e^{-x})$                    |    ln，数据来自迭代寄存器，结果存入迭代寄存器，无需常数码    |
|     $a*x$     |  0001  |   10   |  000   |                   $2\ln(1+e^{-x})$                   | 乘法，数据来自迭代寄存器，结果存入迭代寄存器，常数码来自加法寄存器0 |
|     $-x$      |  0011  |   10   |  000   |                  $-2\ln(1+e^{-x})$                   |   取反，数据来自迭代寄存器，结果存入迭代寄存器，无需常数码   |
|     $e^x$     |  0100  |   10   |  000   |                 $e^{-2ln(1+e^{-x})}$                 |  e指数，数据来自迭代寄存器，结果存入迭代寄存器，无需常数码   |
|     $-x$      |  0011  |   10   |  000   |                $-e^{-2ln(1+e^{-x})}$                 |   取反，数据来自迭代寄存器，结果存入迭代寄存器，无需常数码   |
|     $\pm$     |  0000  |   11   |  000   |                $1-e^{-2ln(1+e^{-x})}$                | 加法，数据来自迭代寄存器，结果存入数据寄存器，常数码来自加法寄存器0 |
|     $-x$      |  0011  |   10   |  000   |                 $e^{-2ln(1+e^{-x})}$                 |   取反，数据来自迭代寄存器，结果存入迭代寄存器，无需常数码   |
|     $\pm$     |  0000  |   10   |  000   |                $1+e^{-2ln(1+e^{-x})}$                | 加法，数据来自迭代寄存器，结果存入迭代寄存器，常数码来自加法寄存器0 |
| $\frac{1}{x}$ |  0101  |   10   |  000   |           $\frac{1}{1+e^{-2ln(1+e^{-x})}}$           |   倒数，数据来自迭代寄存器，结果存入迭代寄存器，无需常数码   |
|     $a*x$     |  0001  |   11   |  011   | $\frac{1-e^{-2ln(1+e^{-x})}}{1+e^{-2ln(1+e^{-x})}}$  | 乘法，数据来自迭代寄存器，结果存入数据寄存器，常数码来自数据寄存器 |
|     $a*x$     |  0001  |   00   |  011   | $x\frac{1-e^{-2ln(1+e^{-x})}}{1+e^{-2ln(1+e^{-x})}}$ | 乘法，数据来自迭代寄存器，结果存入数据寄存器，常数码来自数据寄存器 |
|               |        |        |        |                                                      |                                                              |



## SELU

$$\text{SELU}(x) = \lambda\left\{ \begin{aligned}x\ x\ge0\\\alpha(e^{x}-1)\ x<0\end{aligned} \right.$$

$$\alpha = 1.6732632423543772848170429916717$$

$$\lambda = 1.0507009873554804934193349852946$$

先配置参数，乘法常数寄存器1配置为1，乘法常数寄存器2配置为$\alpha$，乘法常数寄存器3配置为$\lambda$，加法常数寄存器0配置为-1



|  算子   | 指令码 | 模式码 | 常数码 |        结果        |                             解释                             |
| :-----: | :----: | :----: | :----: | :----------------: | :----------------------------------------------------------: |
| $e^{x}$ |  0100  |   00   |  000   |      $e^{x}$       |  e指数，数据来自原始寄存器，结果存入迭代寄存器，无需常数码   |
|  $\pm$  |  0000  |   10   |  000   |     $e^{x}-1$      |   加法，数据来自迭代寄存器，结果存入迭代寄存器，无需常数码   |
|  $a*x$  |  0001  |   10   |  001   | $\alpha(e^{x}-1)$  | 乘法，数据来自迭代寄存器，结果存入迭代寄存器，常数码来自乘法寄存器2 |
|  $a*x$  |  0001  |   01   |  000   |        $x$         | 乘法，数据来自原始寄存器，结果存入数据寄存器，常数码来自乘法寄存器1 |
|  $\le$  |  0110  |   00   |  000   |                    |   比较，数据来自原始寄存器，结果存入迭代寄存器，无需常数码   |
|  $a*x$  |  0001  |   10   |  010   | $\lambda * result$ | 乘法，数据来自迭代寄存器，结果存入迭代寄存器，常数码来自乘法寄存器3 |

